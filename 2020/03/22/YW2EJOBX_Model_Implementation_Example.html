<table>
  <thead>
    <tr>
      <th> </th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Genre</td>
      <td>Web Option</td>
    </tr>
    <tr>
      <td>Document Title</td>
      <td>YW2EJOBX Model Implementation Example</td>
    </tr>
    <tr>
      <td>Author</td>
      <td>Raghunath Daita</td>
    </tr>
    <tr>
      <td>Last Saved Date</td>
      <td>December 27, 2012</td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Revision</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th> </th>
      <th> </th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Revision Date</strong></td>
      <td><strong>Last Revision By</strong></td>
      <td><strong>Reason for Change</strong></td>
    </tr>
    <tr>
      <td>27/Dec/2012</td>
      <td>Raghunath_Daita_ DAIRA01</td>
      <td>Created Document</td>
    </tr>
  </tbody>
</table>

<p>NOTE 1: When changing a document, make sure to add a row in the table above, and to update last saved data and revision number in the top table.<br />
NOTE 2: Make sure to update the table of contents (right-click table of contents&gt; update field &gt; update entire field).</p>

<h1 id="table-of-contents">Table of contents</h1>

<p><a href="#table-of-contents">Table of contents 2</a></p>

<p><a href="#introduction-to-yw2ejobx">Introduction to YW2EJOBX 3</a></p>

<p><a href="#sample-implementation-of-yw2ejobx-api">Sample Implementation of YW2EJOBX API 3</a></p>

<p><a href="#steps-to-implement-yw2ejobx-api-in-a-ca-2e-model">Steps to implement YW2EJOBX API in a CA 2E model 4</a></p>

<p><a href="#known-problem-with-the-yw2ejobx-api">Known Problem with the YW2EJOBX API 13</a></p>

<p># <br />
Introduction to YW2EJOBX</p>

<p>The YW2EJOBX API is shipped as part of Web Option and can be used by an application program to determine whether a specified job is a Web Option client job or not. This identification can be used to carry out user specific actions based on whether a Job is a Web Option job or a 5250 job, such as providing a specific menu system based on the type of the Job.</p>

<p>The API is documented in detail in the following location</p>

<p>Y2WEB/QTXTSRC (YW2EJOBX)</p>

<h1 id="sample-implementation-of-yw2ejobx-api">Sample Implementation of YW2EJOBX API</h1>

<p>A detailed implementation method for the YW2EJOBX API has not been included within the standard CA 2E manuals. To overcome this, a sample implementation of the YW2EJOBX API in a CA 2E model has been outlined in this document.</p>

<p>## <br />
Steps to implement YW2EJOBX API in a CA 2E model</p>

<p>1)  Create a STR file, say “Web Option Session Data” with the following fields</p>

<blockquote>
  <p><strong><span class="underline">Field Name</span>                                     <span class="underline">Field Type</span>       <span class="underline">Length</span></strong></p>
</blockquote>

<p>1)  Web Session Identifier TXT                     16</p>

<p>2)  Web VT Handle                           TXT                       25</p>

<p>3)  Web Job Name                            VNM                    10</p>

<p>4)  Web Job User                                VNM                   10</p>

<p>5)  Web Job Number                        TXT                       6</p>

<p>6)  Web Timeout Value                    NBR                      10, 0</p>

<p>7)  Web Start Time                              TXT                       6      </p>

<p>8)  Web Last Transaction                    TXT                       6</p>

<p>9)  Web End Time                                TXT                       6</p>

<p>10) Web Session Index                         NBR                      5, 0</p>

<p>11) Web Panel ID                                  TXT                       128</p>

<p>12) Web Job Status                               STS                       1</p>

<p>13) Web URL                                          TXT                      25</p>

<p>14) Web Script Flag                               STS                    1</p>

<p>15) Web Script Name                           TXT                      10</p>

<p>16) Web Script Label                           TXT                     10</p>

<p>17) Web Server Job Number             TXT                     6</p>

<p>18) Web Server User Profile              VNM                 10</p>

<p>19) Web Auto Disconnect                 STS                     1</p>

<p>20) Web Job Stage                               STS                     1</p>

<p>21) Web Signon Attempts                  NBR                    5, 0</p>

<p>22) Web JIT Only                                  STS                     1</p>

<p>23) Web Value List Lib                       VNM                 10</p>

<p>24) Web Value List File                      VNM                 10</p>

<p>25) Web Prompt Message File          VNM                 10</p>

<blockquote>
  <p>Define two separate fields as follows</p>
</blockquote>

<p>1)  Web Option Library VNM 10</p>

<p>2)  Web Option Job Status STS 10</p>

<blockquote>
  <p>(Define a VAL condition “ACTIVE” for “Web Option Job Status” field, with a value of “*ACTIVE”.)</p>
</blockquote>

<p>2)  Zoom into the EDIT FUNCTIONS screen of this STR file.</p>

<p>3)  Create an EXCUSRSRC of type RP4, say “CPY Web Opt CTLUSRSPC_P”. Include a copybook as shown below</p>

<blockquote>
  <p>D/COPY QRPGLECPY,YCTLUSRSPC</p>
</blockquote>

<p><img src="2020-03-22-YW2EJOBX_Model_Implementation_Example/media/image1.jpeg" alt="cid:image001.jpg@01CDE3AD.287F9670" /></p>

<blockquote>
  <p>This includes the Web Option Control User Space copybook on subsequent EXCUSRSRC inclusion, into the final function.</p>
</blockquote>

<p>4)  Create another EXCUSRSRC of type RP4, say “CPY Web Opt Job API_P”. Include a copybook as shown below.</p>

<p>D/COPY QRPGLECPY,YW2EJOBX_P</p>

<p><img src="2020-03-22-YW2EJOBX_Model_Implementation_Example/media/image2.jpeg" alt="cid:image002.jpg@01CDE3AD.287F9670" /></p>

<blockquote>
  <p>This includes the YW2EJOBX_P copybook on subsequent EXCUSRSRC inclusion, into the final function. This copybook contains the YW2EJOBX call interface and the necessary parameter list.</p>
</blockquote>

<p>5)  Create another EXCUSRSRC, say, “SRC Web Option Job API”, such that it has three parameters.</p>

<p><img src="2020-03-22-YW2EJOBX_Model_Implementation_Example/media/image3.jpeg" alt="cid:image006.jpg@01CDE3AD.287F9670" /></p>

<p>Web Option Library, Web Option Job Status  are “I”nput parameters and all the fields in Web Option Session Data are “O”utput, except Web Job Name, Web Job User and Web Job Number, as shown below</p>

<p><img src="2020-03-22-YW2EJOBX_Model_Implementation_Example/media/image4.jpeg" alt="cid:image007.jpg@01CDE3AD.287F9670" /></p>

<p>6)  Within the source section of this EXCUSRSRC, code needs to be included which takes in a Job Name, Job User and Job Number and calls the “CheckWebOptionJob” procedure and subsequently displays the result of whether the job is an r8.5/r8.6 Web Option related job. A sample code which can be included in this copybook has been attached below. Note that within this source, the fields “JobName”, “JobUser” and “JobNumber” fields are being initialized with P1+corresponding implementation name for “Web Job Name”, “Web Job User” and “Web Job Number” respectively. Also, the field</p>

<p>“W2ELib” = P2 + corresponding Implementation name of Web Option Library and the field “JobStatus” = P3 + corresponding Implementation name of “Web option Job Status”.</p>

<p>7)  Create an EXCEXTFUN, say, “WEB Option Job API”, such that it has three parameters as shown below.</p>

<p><img src="2020-03-22-YW2EJOBX_Model_Implementation_Example/media/image6.jpeg" alt="cid:image018.jpg@01CDE3AD.287F9670" /></p>

<p>“Web Option Library” and “Web Option Job Status” are “I”nput parameters and all the fields in Web Option Session Data are “O”utput, except Web Job Name, Web Job User and Web Job Number. Web Job Name, Web Job User and Web Job Number need to be defined with usage as “B”oth.</p>

<p>8)  Within the AD of this function. Include calls to the following functions.</p>

<p>FIL - “Web Option Session Data”, FUN – “CPY Web Opt Job API_P”</p>

<blockquote>
  <p>FIL – “Web Option Session Data”, FUN – “CPY Web Opt CTLUSRSPC_P”</p>

  <p>FIL – “Web Option Session Data”, FUN – “SRC Web Option Job API”</p>

  <p>As shown below</p>
</blockquote>

<p><img src="2020-03-22-YW2EJOBX_Model_Implementation_Example/media/image7.jpeg" alt="cid:image019.jpg@01CDE3AD.287F9670" /></p>

<blockquote>
  <p>Refer to the FIL – “Web Option Session Data” Function – “WEB Option Job API” for the parameter list to be used when including the function “SRC Web Option Job API” in this EEF.</p>

  <p>At this stage, we have the stage set to call the YW2EJOBX API. All that we need now is to have a Wrapper in place to call this EEF, with an easy call parameter interface.</p>
</blockquote>

<p>9)  Create another EXCEXTFUN, say “WEB API Wrapper”, such that it has parameters as shown below.</p>

<blockquote>
  <p><img src="2020-03-22-YW2EJOBX_Model_Implementation_Example/media/image8.jpeg" alt="cid:image021.jpg@01CDE3AD.287F9670" /></p>
</blockquote>

<p>“Web Job Name”, “Web Job User”, “Web Job Number” and “Web Option Library” are “I”nput parameters.</p>

<p>10) Within the AD of this function, include a call to the EEF function</p>

<p>“WEB Option Job API” as shown below.</p>

<p><img src="2020-03-22-YW2EJOBX_Model_Implementation_Example/media/image9.png" alt="" /></p>

<p>Refer to the FIL – “Web Option Session Data” Function – “WEB API Wrapper” for the parameter list to be used when calling the function “WEB Option Job API” in this EEF.</p>

<p>11) Generate the two EEF’s “WEB Option Job API” and “WEB API Wrapper”.</p>

<p>12) Call the “Web API Wrapper” function with the details of a Web Option job.</p>

<p>An example is as follows</p>

<p>Web Job Name, e.g., QPADEV000J</p>

<p>Web Job User, e.g., DAIRA01</p>

<p>Web Job Number, e.g., 618314</p>

<p>Web Option Library, e.g., RXD86WEB</p>

<p>If the Job details provided are related to the Web Option version of the Web Option Library provided, then we a result gets displayed.</p>

<p>The output of the call to the “Web API Wrapper” function, based on the input provided, is as follows</p>

<ul>
  <li>
    <p>If the Job details provided are related to r8.5 and the Web Option library provided is related to r8.5, then “r8.5_Web_Option related job” is displayed.</p>
  </li>
  <li>
    <p>If the Job details provided are related to r8.6 and the Web Option library provided is related to r8.6, then “r8.6_Web_Option related job” is displayed.</p>
  </li>
  <li>
    <p>If the Job details provided are related to an earlier version of Web Option and a valid Web Option library name is passed, then “Web Option job” is displayed.</p>
  </li>
  <li>
    <p>If the Job details provided are not related to Web Option, then “5250 job” is displayed.</p>
  </li>
</ul>

<h2 id="known-problem-with-the-yw2ejobx-api">Known Problem with the YW2EJOBX API</h2>

<p>In all versions of YW2EJOBX API upto the current GA r8.6, the API was version incompatible i.e., when it is attempted to identify if a running job is a Web Option related job or not, the API does not identify the job correctly, when the release of Web Option associated with the job is different from that of the YW2EJOBX API.</p>

<p>As an example, when the r8.6 version of YW2EJOBX API is used and the job details of an r8.6 related Web Option Job and an r8.6 related Web Option library are provided as inputs, the job gets identified correctly. However, when the r8.6 version of YW2EJOBX API is used and the job details of an r8.5 related Web Option Job and an r8.5 related Web Option library are provided as inputs, the job does not get identified correctly.</p>

<p>Changes have been carried in YC2WEB242B to make the YW2EJOBX API as version independent. Using the modified YW2EJOBX API, it is possible to identify a Web Option related job, irrespective of the version of job related Web Option and YW2EJOBX API. In other words, after the changes in YC2WEB242B, when the modified YW2EJOBX API is used, it is possible to identify both r8.5 and r8.6 related Web Option jobs with the same modified YW2EJOBX, thereby making it version independent.</p>
